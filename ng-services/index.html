<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Angular Services</title>
    <link rel="icon" href="../common/img/favicon.ico">

    <!-- Showing Examples -->
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <link rel="stylesheet" href="../node_modules/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="../css/lib/style.css">
    <link rel="stylesheet" href="../node_modules/reveal.js/css/theme/white.css" id="theme">

    <link rel="stylesheet" href="../common/css/common.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../common/css/github-gist.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? '../node_modules/reveal.js/css/print/pdf.css' : '../node_modules/reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="../node_modules/reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>
<body>
<section class="angular-link">
    <a href="http://angular.io" target="_blank"><img height="50px" src="../common/img/angular.svg"></a>
</section>
<section class="devon-link">
    <a href="http://devonfw.github.io" target="_blank"><img height="30px" src="../common/img/devon_logo_blue.png"></a>
</section>
<div class="devon reveal">
    <div class="slides">
        <section>
            <h2 class="no-text-transform">Services and Dependency Injection</h2>
            <img src="img/services-and-di-architecture.png">
        </section>

        <section>
            <h2 class="no-text-transform">A Service is...</h2>
            <ul>
                <li>for application logic</li>
                <li>for data retrieval</li>
                <li>consumed by components or other services</li>
            </ul>
        </section>

        <section>
            <h2 class="no-text-transform">A Service is...</h2>
            <ul>
                <li>typically a class with a narrow, well-defined purpose</li>
                <li>lazily instantiated</li>
                <li>injected by an Injector</li>
                <li>a Singleton (almost)</li>
            </ul>
        </section>

        <section>
            <p><code>ng generate service book</code></p>
            <pre><code class="typescript" data-trim>
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root',
})
export class BookService {
}
            </code></pre>
        </section>

        <section>
            <pre><code class="hljs typescript" data-trim data-noescape>
@Injectable({
  provideIn: 'root'
})
export class BookService {
  private books: Book[] = [{...}, {...}];

  findAll(): Observable&lt;Book[]&gt; {
    return of(this.books);
  }
}
            </code></pre>
            <code>provideIn: 'root'</code>
            <p>... registers the service in the root injector.</p>
        </section>
        <section>
            <p class="no-text-transform">Component consumes a service making use of the <span class="highlight">Dependency Injection</span></p>
            <pre><code class="hljs typescript" data-trim data-noescape>
@Component({...})
export class BookOverviewComponent implements OnInit {
  books$ = this.bookService.findAll();

  constructor(private <mark>bookService: BookService</mark>) {}
}
            </code></pre>
        </section>
        <section>
            <div class="title-with-image">
                <img src="img/injector-injects.png">
                <h2 class="no-text-transform">Dependency Injection</h2>
            </div>
            <p>Dependency injection is a way to supply a new instance of a class with the <span class="highlight">fully-formed dependencies</span> it requires.</p>
            <p><span class="highlight">Most dependencies are services</span>. Angular uses dependency injection to <span class="highlight">provide new components with the services</span> they need.</p>
        </section>
        <section>
            <h2 class="no-text-transform">Injector</h2>
            <p>When Angular creates a component, it asks an injector for the services that the component requires.</p>
            <p>An injector keeps one instance per defined service</p>
            <p>Each component instance has its own injector. The tree of components parallels the tree of injectors.</p>
        </section>
        <section>
            <h2 class="no-text-transform">Providers</h2>
            <p>An injector can create a new service instance from a provider</p>
            <p>A provider is a recipe for creating a service <span class="highlight">with configuration</span></p>
            <p>You can register providers in modules or in components</p>
            <p>In general, providers are <span class="highlight">added to the root module</span> so that the same instance of a service is available everywhere</p>
        </section>
        <section>
            <img src="img/injector-bubbling.svg" alt="Injector Bubbling" class="plain no-border">
        </section>
    </div>
</div>

<script src="../node_modules/reveal.js/js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        minScale: 1,
        maxScale: 1,
        width: 1080,
        height: 800,
        margin: 0.01,
        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            { src: '../node_modules/reveal.js/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            } },
            { src: '../node_modules/reveal.js/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: '../node_modules/reveal.js/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: '../node_modules/reveal.js/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            } },
            { src: '../node_modules/reveal.js/plugin/zoom-js/zoom.js', async: true },
            { src: '../node_modules/reveal.js/plugin/notes/notes.js', async: true }
        ]
    });

</script>
</body>
</html>
